<apex:page standardController="Wish_Expense__c" extensions="WishBudgetForm_AC10" standardStylesheets="false" id="Pge" sidebar="false" showHeader="false">  
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
    <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous"/>
            <!-- Optional theme -->
                <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous"/>
                    <!-- Latest compiled and minified JavaScript -->
                        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <apex:pagemessages />
    <apex:includeScript value="{!URLFOR($Resource.CumulusStaticResources, '/npsp-slds/modal.js')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.CumulusStaticResources, '/npsp-slds/npsp-common.css')}" />
    <apex:stylesheet value="{!URLFOR($Resource.SLDS, '/0_12_2/assets/styles/salesforce-lightning-design-system-vf.min.css')}"/>
    <div class="slds">
        <style type="text/css">
            body{font-size:10px !important; width:100%}
            th {font-size:10px !important}
            .slds .slds-tabs--path__stage {
            /* fix weird issue where check icon was not aligning properly */
            margin-top: 0.5rem;
            }
            .slds-tabs--path * {
            cursor: default !important;
            }
            .lookupHoverDetail {
            /* hide those ugly hover dialogs that come with using apex:outputField with lookups */
            display: none !important;
            }
            .kill-white-space {
            /* some visualforce elements inject extra tags and linebreaks,
            causing unwanted spaces to appear in output. this fixes that */
            display: inline-flex;
            }
        </style>
        <style type="text/css">
            .mybutton {
            display: inline-block;
            position: relative;
            margin: 10px;
            padding: 0 20px;
            text-align: center;
            text-decoration: none;
            font: bold 12px/25px Arial, sans-serif;
            box-shadow:#000 4px 4px 5px;
            }
            .custPopup{
            background-color: white;
            border: 1px solid#E5c130;
            border-radius: 4px;
            z-index: 9999;
            left: 50%;
            padding:10px;
            position: absolute;
            /* These are the 3 css properties you will need to change so the popup 
            displays in the center of the screen. First set the width. Then set 
            margin-left to negative half of what the width is. You can add 
            the height property for a fixed size pop up if you want.*/
            width: 500px;
            margin-left: -250px;
            top:100px;
            }
            .popupBackground{
            background-color:black;
            opacity: 0.20;
            filter: alpha(opacity = 20);
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 9998;
            }
            .dupHasRes { table-layout: fixed; }
            table td  th{ overflow: hidden; padding:3px; font-size: 10px;}
            table { border-collapse: collapse; }
             th, td{
              border-right: solid 1px #d8dde6; 
              border-left: solid 1px #d8dde6;
            }
            .hoverTable tr.overAllStatusRow{font-weight:700;background-color:#ddb929}.whiteHead,td.whiteHead{color:#fff!important;padding-left:10px}.hoverTable tr.dataRow:hover{background-color:#e3f3ff}.hoverTable #overAllStatusRow:hover{background-color:#ddb929}.Approved{background-color:#a1f78d}.Rejected{background-color:#fb8a8c}.Removed{background-color: #c0bebc}.Pending{background-color:#ffd74b}.approval_btn{-webkit-border-radius:4;-moz-border-radius:4;border-radius:4px;font-family:Arial;color:#fff!important;font-size:10.8px;background:#ddb929;padding:5px 10px;margin-left:5px;text-decoration:none}.approval_btn:hover{background:#ebca44;background-image:-webkit-linear-gradient(top,#ebca44,#d1ad1b);background-image:-moz-linear-gradient(top,#ebca44,#d1ad1b);background-image:-ms-linear-gradient(top,#ebca44,#d1ad1b);background-image:-o-linear-gradient(top,#ebca44,#d1ad1b);background-image:linear-gradient(to bottom,#ebca44,#d1ad1b);text-decoration:none}.hoverTable tr#headerRow,.hoverTable tr#headerRow:hover{background:#f2f3f3;border-color:#e0e3e5}.hoverTable tr#headerRow td{padding:11px 0}
            
            .tdBudget{
                background: rgba(184,209,252,.5);
              
            }
            .tdProjected
            {
                 background: rgba(251,199,44,.2);
            }
        </style>
          
        <apex:form id="newExpense">
            <div class="slds-card slds-m-horizontal--large slds-card--empty font-size-x-small" style="font-size:12px !important">
                <div class="slds-card__header slds-grid ">
                    <div class="col-lg-2">
                        <apex:selectList id="WishExpenceType" value="{!newExpenseType}" size="1"  styleClass="form-control col-lg-2 new-expType">
                            <apex:selectOptions value="{!WishExpenceTypes}"/>
                        </apex:selectList>
                    </div> 
                    <div style="float:left">
                        <apex:commandButton styleclass="btn btn-info btn-sm" action="{!addExpenseType}" value="Add New Expense Type" onclick=" return validateNewExpenseType();"/>
                    </div>         
                </div>
                <div class="slds-card__body">
                    <apex:pageBlock mode="detail" id="rform" >
                        <!--<table class="slds-table slds-table--bordered slds-max-medium-table--stacked-horizontal dupHasRes font-size-x-small">-->
                        <table class="slds-table slds-table--bordered .slds-table--col-bordered slds-table--cell-buffer font-size-x-small table table-striped">
                            <tr>
                                <th class="slds-text-heading--label" scope="col"  colspan="7"></th >
                                <th class="slds-text-heading--label slds-text-align--center tdBudget" scope="col"  Style="width:120px"  colspan="2">Budget</th >
                                <th class="slds-text-heading--label slds-text-align--center tdProjected" scope="col"  Style="width:120px" colspan="2">Projected</th >
                                <th class="slds-text-heading--label slds-text-align--center" scope="col"  Style="width:60px"></th >
                                <th class="slds-text-heading--label slds-text-align--center tdBudget" scope="col"  Style="width:120px" colspan="2">Actual</th >
                                <th class="slds-text-heading--label slds-text-align--center tdProjected" scope="col"  Style="width:120px" colspan="2">FE Posted</th >
                                <th class="slds-text-heading--label slds-text-align--center" scope="col"  Style="width:60px"></th >
                                <th class="slds-text-heading--label slds-text-align--center" scope="col"  Style="width:60px"></th >
                            </tr>
                            <tr>
                                <th class="slds-text-heading--label" scope="col" style="width:200px" >Transaction Code</th >
                                <th class="slds-text-heading--label" scope="col" Style="width:60px">Post Date</th >
                                <th class="slds-text-heading--label slds-cell-wrap" scope="col" Style="width:60px">Transaction#</th >
                                <th class="slds-text-heading--label slds-cell-wrap" scope="col" Style="width:60px">Account#</th >
                                <th class="slds-text-heading--label slds-cell-wrap" scope="col" Style="width:60px">Dept/Div</th >
                                <th class="slds-text-heading--label slds-cell-wrap" scope="col" Style="width:125px">Account Desc</th >
                                <th class="slds-text-heading--label slds-cell-wrap" scope="col" Style="width:60px">Journal Ref</th >
                                <th class="slds-text-heading--label slds-cell-wrap tdBudget" scope="col" Style="width:60px">Cash</th >
                                <th class="slds-text-heading--label tdBudget" scope="col" Style="width:60px">In Kind</th >
                                <th class="slds-text-heading--label slds-cell-wrap tdProjected" scope="col" Style="width:60px">Cash</th >
                                <th class="slds-text-heading--label tdProjected" scope="col" Style="width:60px">In Kind</th >
                                <th class="slds-text-heading--label" scope="col" Style="width:60px">%Diff(B-P)</th >
                                <th class="slds-text-heading--label slds-cell-wrap tdBudget tdBudget" scope="col" Style="width:60px">Cash</th >
                                <th class="slds-text-heading--label tdBudget" scope="col" Style="width:60px">In Kind</th >
                                <th class="slds-text-heading--label slds-cell-wrap tdProjected" scope="col" Style="width:60px">Cash</th >
                                <th class="slds-text-heading--label tdProjected"  scope="col" Style="width:60px">In Kind</th >
                                <th class="slds-text-heading--label" scope="col" Style="width:60px">%Diff(P-A)</th >
                                <th class="slds-text-heading--label slds-cell-wrap" scope="col" Style="width:60px"></th >
                                
                            </tr>
                            <apex:actionFunction name="deleteRecord" action="{!RemoveWrapper}" rerender="Block">
                                <apex:param name="p1" assignTo="{!transCodeid}" value="transCodeid" />
                                <apex:param name="p2" assignTo="{!expenseTypekey}" value="expenseTypekey" />
                                
                            </apex:actionFunction>  
                            <apex:variable value="{!0}" var="cnt"/>
                            <apex:variable value="{!0}" var="cntTemp"/> 
                            <apex:repeat value="{!wishExpenseTypes}" var="expenseType"> 
                                <tr id="{!cntTemp}" class="clickable" data-toggle="collapse" data-target=".{!cntTemp}collapsed">
                                    <td  align="left" >
                                        <apex:commandLink action="{!addExpense}"><apex:image value="https://cdn4.iconfinder.com/data/icons/meBaze-Freebies/512/add.png" style="height:20px"/>
                                            <apex:param name="expenseType" value="{!expenseType}" assignTo="{!expenseType}"/>
                                        </apex:commandLink>
                                        
                                        <a  class="accordion-toggle" data-toggle="collapse" href="#expenseBlock{!cntTemp}" >{!expenseType}</a>
                                        <!-- <button type="button" class="btn" data-toggle="collapse" data-target="#expenseBlock{!cntTemp}" >{!expenseType}</button>-->
                                         
                                    </td>
                                    <td colspan="6"  >
                                        
                                    </td>
                                    
                                    <apex:outputpanel rendered="{!(SumExpensewrappers[expenseType]) != null}" >
                                        <td class="slds-text-align--right tdBudget" Style="width:60px"><b>${!SumExpensewrappers[expenseType].sumbudgetCash}</b></td>
                                        <td class="slds-text-align--right tdBudget" Style="width:60px"><b>${!SumExpensewrappers[expenseType].sumbudgetInKind}</b></td>
                                        <td class="slds-text-align--right tdProjected" Style="width:60px"><b>${!SumExpensewrappers[expenseType].sumprojectedCash}</b></td>
                                        <td class="slds-text-align--right tdProjected" Style="width:60px"><b>${!SumExpensewrappers[expenseType].sumprojectedInkind}</b></td>
                                        <td class="slds-text-align--right" Style="width:60px"><b>{!SumExpensewrappers[expenseType].sumBtoPDiff}%</b></td>
                                        <td class="slds-text-align--right tdBudget" Style="width:60px"><b>${!SumExpensewrappers[expenseType].sumactualCash}</b></td>
                                        <td class="slds-text-align--righ tdBudget" Style="width:60px"><b>${!SumExpensewrappers[expenseType].sumactualInKind}</b></td>
                                        <td class="slds-text-align--right tdProjected" Style="width:60px"><b>${!SumExpensewrappers[expenseType].sumFEPostedCash}</b></td>
                                        <td class="slds-text-align--right tdProjected" Style="width:60px"><b>${!SumExpensewrappers[expenseType].sumFEPostedInKind}</b></td>
                                        <td class="slds-text-align--right" Style="width:60px"><b>{!SumExpensewrappers[expenseType].sumPtoADiff}%</b></td>
                                        <td  Style="width:60px"><b></b></td>
                                        
                                    </apex:outputpanel>
                                </tr>  
                                <div  >
                                <apex:repeat value="{!wishExpensewrap[expenseType]}" var="expense" id="Block"> 
                                    <!-- <tr id="expenseBlock{!cntTemp}"  class="collapse in"> -->
                                    <tr class="collapse out budgets {!cntTemp}collapsed" >
                                        <!-- <apex:outputPanel rendered="{!AND(true, expense.Wish_Expense_Transaction_Code__c !=null )}"> -->
                                         <apex:outputPanel rendered="{!AND(true, expense.Id !=null )}">
                                          <!--  <apex:inputHidden value="{!expense.Wish_Expense_Transaction_Code__c}" id="theHiddenInput"/>   -->

                                            <apex:outputPanel rendered="{!expense.RecordType.Name == 'Budgeting'}">
                                                <td>
                                                    <apex:selectList id="TransacationCode1" value="{!expense.Wish_Expense_Transaction_Code__c }" size="1" required="true" style="width:100%">
                                                        <apex:selectOptions value="{!TransCodeOptionsMap[expenseType]}"/>
                                                    </apex:selectList>
                                                </td>
                                            </apex:outputPanel>

                                            <apex:outputPanel rendered="{!expense.RecordType.Name == 'Finance'}">
                                                <td><apex:OutPuttext value="{!expense.Wish_Expense_Transaction_Code__r.Name }" style="width:60px" />
                                                </td>
                                            </apex:outputPanel>

                                            <td class="slds-cell-wrap"><apex:OutPuttext value="{0,date,short}" style="width:60px"><apex:param value="{!expense.Post_Date__c}"/></apex:OutPuttext></td>
                                            <td class="slds-cell-wrap"><apex:OutPuttext value="{!expense.Transaction__c}" style="width:60px" /></td>
                                             
                                             <apex:outputPanel rendered="{!AND(expense.Wish_Expense_Approval_Status__c == '',expense.Wish_Expense_Approval_Status__c == '')}">
                                                <td class="slds-cell-wrap slds-text-align--right" style="width:60px;">
                                                    <apex:actionRegion >
                                                        <apex:outputField value="{!expense.Account_Number__c}">
                                                            <apex:inlineEditSupport event="onClick" showOnEdit="saveButton,cancelButton" />
                                                        </apex:outputField>
                                                    </apex:actionRegion>
                                                </td>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!If(expense.Wish_Expense_Approval_Status__c != '',true,false)}">
                                                <td class="slds-cell-wrap slds-text-align--right" style="width:60px;"><apex:OutPutField value="{!expense.Account_Number__c}"/></td>
                                            </apex:outputPanel>
                                            
                                           <!-- <td class="slds-cell-wrap"><apex:OutPutField value="{!expense.Account_Number__c}" style="width:60px"/></td> -->
                                           
                                            <apex:outputPanel rendered="{!AND(expense.Wish_Expense_Approval_Status__c == '',expense.Wish_Expense_Approval_Status__c == '')}">
                                                <td class="slds-cell-wrap slds-text-align--right" style="width:60px;">
                                                    <apex:actionRegion >
                                                        <apex:outputField value="{!expense.Department_Division__c}">
                                                            <apex:inlineEditSupport event="onClick" showOnEdit="saveButton,cancelButton" />
                                                        </apex:outputField>
                                                      
                                                    </apex:actionRegion>
                                                </td>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!If(expense.Wish_Expense_Approval_Status__c != '',true,false)}">
                                                <td class="slds-cell-wrap slds-text-align--right" style="width:60px;"><apex:OutPutField value="{!expense.Department_Division__c}"/></td>
                                            </apex:outputPanel>
                                            
                                            <!-- <td class="slds-cell-wrap"><apex:OutPutField value="{!expense.Department_Division__c}" style="width:60px"/></td> -->
                                            
                                            <apex:outputPanel rendered="{!AND(expense.Wish_Expense_Approval_Status__c == '',expense.Wish_Expense_Approval_Status__c == '')}">
                                                <td class="slds-cell-wrap slds-text-align--right" style="width:60px;">
                                                    <apex:actionRegion >
                                                        <apex:outputField value="{!expense.Account_Description__c}">
                                                            <apex:inlineEditSupport event="onClick" showOnEdit="saveButton,cancelButton" />
                                                        </apex:outputField>
                                                    </apex:actionRegion>
                                                </td>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!If(expense.Wish_Expense_Approval_Status__c != '',true,false)}">
                                                <td class="slds-cell-wrap slds-text-align--right" style="width:60px;"><apex:OutPutField value="{!expense.Account_Description__c}"/></td>
                                            </apex:outputPanel>
                                            
                                            <!--<td class="slds-cell-wrap"><apex:OutPutField value="{!expense.Account_Description__c}" style="width:125px"/></td>-->
                                            <td class="slds-cell-wrap"><apex:OutPuttext value="{!expense.Journal_Reference__c}" style="width:60px" /></td>

                                            <apex:outputPanel rendered="{!AND(expense.Wish_Expense_Approval_Status__c == '',expense.Wish_Expense_Approval_Status__c == '')}">
                                                <td class="slds-cell-wrap slds-text-align--right tdBudget" style="width:60px">
                                                    <apex:actionRegion >
                                                        <apex:outputField value="{!expense.Budget_Cash__c}">
                                                            <apex:inlineEditSupport event="onClick" showOnEdit="saveButton,cancelButton" />
                                                        </apex:outputField>
                                                    </apex:actionRegion>
                                                </td>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!If(expense.Wish_Expense_Approval_Status__c != '',true,false)}">
                                                <td class="slds-cell-wrap slds-text-align--right tdBudget" style="width:60px"><apex:OutPutField value="{!expense.Budget_Cash__c}"/></td>
                                            </apex:outputPanel>

                                            <apex:outputPanel rendered="{!AND(expense.Wish_Expense_Approval_Status__c == '',expense.Wish_Expense_Approval_Status__c == '')}">
                                                <td class="slds-cell-wrap slds-text-align--right tdBudget" style="width:60px">
                                                    <apex:actionRegion >
                                                        <apex:outputField value="{!expense.Budget_In_Kind__c}">
                                                            <apex:inlineEditSupport event="onClick" showOnEdit="saveButton,cancelButton" />
                                                        </apex:outputField>
                                                    </apex:actionRegion>
                                                </td>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!If(expense.Wish_Expense_Approval_Status__c != '',true,false)}">
                                                <td class="slds-cell-wrap slds-text-align--right tdBudget" style="width:60px"><apex:OutPutField value="{!expense.Budget_In_Kind__c}"/></td>
                                            </apex:outputPanel>                                           
                                            




                                            <!--<apex:outputPanel rendered="{!If(expense.Wish_Expense_Approval_Status__c != '',true,false)}">
                                                <td class="slds-cell-wrap"><apex:OutPutField value="{!expense.Projected_Cash__c}" style="width:60px"/></td>
                                            </apex:outputPanel>-->
                                            
                                           <!-- <apex:outputPanel rendered="{!If(expense.Wish_Expense_Approval_Status__c == '',true,false)}">-->
                                                <td class="slds-cell-wrap slds-text-align--right tdProjected" style="width:60px">
                                                    <apex:actionRegion >
                                                        <apex:outputField value="{!expense.Projected_Cash__c}">
                                                            <apex:inlineEditSupport event="onClick" showOnEdit="saveButton,cancelButton" />
                                                        </apex:outputField>
                                                    </apex:actionRegion>
                                                </td>
                                           <!-- </apex:outputPanel>-->
                                            
                                            <!--<apex:outputPanel rendered="{!If(expense.Wish_Expense_Approval_Status__c != '',true,false)}">
                                                <td class="slds-cell-wrap" style="width:60px">
                                                    <apex:OutPutField value="{!expense.Projected_In_Kind__c}" style="width:125px"/></td>
                                            </apex:outputPanel>-->
                                            
                                            <!--<apex:outputPanel rendered="{!If(expense.Wish_Expense_Approval_Status__c == '',true,false)}">-->
                                                <td class="slds-cell-wrap slds-text-align--right tdProjected" style="width:60px">
                                                    <apex:actionRegion >
                                                        <apex:outputField value="{!expense.Projected_In_Kind__c}">
                                                            <apex:inlineEditSupport event="onClick" showOnEdit="saveButton,cancelButton" />
                                                        </apex:outputField>
                                                    </apex:actionRegion>
                                                </td>
                                            <!--</apex:outputPanel>-->


                                            




                                            
                                            <td class="slds-cell-wrap slds-text-align--right" style="width:60px"><apex:OutPuttext value="" style="width:60px"/></td>
                                            <!--<apex:outputPanel rendered="{!If(expense.Wish_Expense_Approval_Status__c != '',true,false)}">
                                                <td class="slds-cell-wrap" style="width:60px">
                                                    <apex:OutPutField value="{!expense.Actual_Cash__c}" style="width:125px"/></td>
                                            </apex:outputPanel>-->
                                            
                                            <!--<apex:outputPanel rendered="{!If(expense.Wish_Expense_Approval_Status__c == '',true,false)}">-->
                                                <td class="slds-cell-wrap slds-text-align--right tdBudget" style="width:60px">
                                                    <apex:actionRegion >
                                                        <apex:outputField value="{!expense.Actual_Cash__c}">
                                                            <apex:inlineEditSupport event="onClick" showOnEdit="saveButton,cancelButton" />
                                                        </apex:outputField>
                                                    </apex:actionRegion>
                                                </td>
                                            <!--</apex:outputPanel>-->

                                            <!--<apex:outputPanel rendered="{!If(expense.Wish_Expense_Approval_Status__c != '',true,false)}">
                                                <td class="slds-cell-wrap" style="width:60px">
                                                    <apex:OutPutField value="{!expense.Actual_In_Kind__c}" style="width:125px"/></td>
                                            </apex:outputPanel>-->
                                            
                                            <!--<apex:outputPanel rendered="{!If(expense.Wish_Expense_Approval_Status__c == '',true,false)}">-->
                                                <td class="slds-cell-wrap slds-text-align--right tdBudget" style="width:60px">
                                                    <apex:actionRegion >
                                                        <apex:outputField value="{!expense.Actual_In_Kind__c}">
                                                            <apex:inlineEditSupport event="onClick" showOnEdit="saveButton,cancelButton" />
                                                        </apex:outputField>
                                                    </apex:actionRegion>
                                                </td>
                                            <!--</apex:outputPanel>-->




                                            <td class="slds-cell-wrap slds-text-align--right tdProjected" style="width:60px"><apex:OutPuttext value="${!expense.FE_Posted_Cash__c}" /></td>
                                            <td class="slds-cell-wrap slds-text-align--right tdProjected" style="width:60px"><apex:OutPuttext value="${!expense.FE_Posted_In_Kind__c}" /></td>
                                            <td class="slds-cell-wrap slds-text-align--right" style="width:60px"><apex:OutPuttext value="" style="width:60px"/></td>
                                            <td class="slds-cell-wrap" style="width:60px">
                                                <div>
                                                    <apex:commandbutton value="Delete" action="{!removeExpense}" reRender="none" styleclass="btn btn-info btn-xs" rendered="{!AND(expense.RecordType.Name != 'Finance',expense.Wish_Expense_Approval_Status__c != 'Approved')}">
                                                        <apex:param name="index" value="{!cnt}"/>
                                                        <apex:param name="expenType" value="{!expenseType}"/>
                                                    </apex:commandbutton>
                                                </div>
                                            </td>
                                            
                                        </apex:outputPanel> 
                                        
                                       <!-- <apex:outputPanel rendered="{!AND(true, expense.Wish_Expense_Transaction_Code__c ==null)}"> -->
                                       <apex:outputPanel rendered="{!AND(true, expense.Id ==null)}">
                                            <td align="left">
                                                <apex:selectList id="TransacationCode" value="{!expense.Wish_Expense_Transaction_Code__c }" size="1" required="true" style="width:100%">
                                                    <apex:selectOptions value="{!TransCodeOptionsMap[expenseType]}"/>
                                                </apex:selectList>
                                            </td>
                                            <td class="slds-text-align--center"><apex:OutPutText value="{!expense.Post_Date__c}"  style="width:60px" /></td>
                                            <td class="slds-text-align--center"><apex:OutPutText value="{!expense.Transaction__c}" style="width:60px" /></td>
                                            <td class="slds-text-align--center"><apex:inputtext value="{!expense.Account_Number__c}" style="width:60px"/></td>
                                            <!-- <td class="slds-text-align--center"><apex:inputtext value="{!expense.Department_Division__c}" style="width:75px"/></td> -->
                                            <td class="slds-text-align--center">
                                               <apex:selectList id="DeptDivision" value="{!expense.Department_Division__c}" size="1" required="true" style="width:100%">
                                                        <apex:selectOptions value="{!DeptDivisions}"/>
                                                </apex:selectList> 
                                            </td>    
                                            <td class="slds-text-align--center" style="width:125px"><apex:selectList id="AccountDesc" value="{!expense.Account_Description__c}" size="1" required="true" >
                                                <apex:selectOption itemvalue="Direct Wish Cash Expense" itemlabel="Direct Wish Cash Expense"/>
                                                <apex:selectOption itemvalue="Direct Wish In-kind Expense" itemlabel="Direct Wish In-kind Expense"/>
                                                <apex:selectOption itemvalue="Direct Wish In-kind Service" itemlabel="Direct Wish In-kind Service"/>
                                                </apex:selectList></td>
                                            <td class="slds-text-align--center"><apex:OutPutText value="{!expense.Journal_Reference__c}" style="width:60px" /></td>
                                            
                                            
                                            <td class="slds-text-align--right tdBudget" style="width:60px">
                                                <apex:outputPanel rendered="{!If(caseApproverStatus == 'Approved',true,false)}">
                                                    <apex:outputtext value="{!expense.Budget_Cash__c}" />
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!If(caseApproverStatus != 'Approved',true,false)}">
                                                    <apex:inputtext value="{!expense.Budget_Cash__c}" />
                                                </apex:outputPanel>
                                            </td>
                                            <td class="slds-text-align--right tdBudget" style="width:60px">
                                                <apex:outputPanel rendered="{!If(caseApproverStatus == 'Approved',true,false)}">
                                                    <apex:outputtext value="{!expense.Budget_In_Kind__c}" />
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!If(caseApproverStatus != 'Approved',true,false)}">
                                                    <apex:inputtext value="{!expense.Budget_In_Kind__c}" />
                                                </apex:outputPanel>
                                                
                                            </td>
                                            <td class="slds-text-align--right tdProjected" style="width:60px"><apex:inputtext value="{!expense.Projected_Cash__c}"  /></td>
                                            <td class="slds-text-align--right tdProjected" style="width:60px"><apex:inputtext value="{!expense.Projected_In_Kind__c}"  /></td>
                                            <td class="slds-text-align--right" style="width:60px"><apex:OutPutText value="" /></td>
                                            <td class="slds-text-align--right tdBudget" style="width:60px"><apex:inputtext value="{!expense.Actual_Cash__c}"  /></td>
                                            <td class="slds-text-align--right tdBudget" style="width:60px"><apex:inputtext value="{!expense.Actual_In_Kind__c}"  /></td>
                                            <td class="slds-text-align--right tdProjected" style="width:60px"><apex:OutPutText value="{!expense.FE_Posted_Cash__c}"  /></td>
                                            <td class="slds-text-align--right tdProjected" style="width:60px" ><apex:OutPutText value="{!expense.FE_Posted_In_Kind__c}" /></td>
                                            <td class="slds-text-align--right" style="width:60px"><apex:OutPutText value="" /></td>
                                            <td class="slds-text-align--center" style="width:60px"><apex:OutPutText value="" /></td>
                                        </apex:outputPanel>  
                                    </tr> 
                                    <apex:variable var="cnt" value="{!cnt+1}"/>
                                </apex:repeat>
                                 
                                <apex:variable var="cnt" value="{!0}"/>
                                </div>
                                 <apex:variable var="cntTemp" value="{!cntTemp+1}"/>
                            </apex:repeat>
                            
                            <tr>
                                <td colspan="7" class="slds-text-align--right" >
                                   <b> Total </b>
                                </td>
                                
                                <apex:outputpanel rendered="{!TotalExpensewrappers != null}" >
                                    <td class="slds-text-align--right tdBudget" Style="width:60px"><b>${!TotalExpensewrappers.sumbudgetCash}</b></td>
                                    <td class="slds-text-align--right tdBudget" Style="width:60px"><b>${!TotalExpensewrappers.sumbudgetInKind}</b></td>
                                    <td class="slds-text-align--right tdProjected" Style="width:60px"><b>${!TotalExpensewrappers.sumprojectedCash}</b></td>
                                    <td class="slds-text-align--right tdProjected"  Style="width:60px"><b>${!TotalExpensewrappers.sumprojectedInkind}</b></td>
                                    <td class="slds-text-align--right" Style="width:60px">{!TotalExpensewrappers.sumBtoPDiff}%</td>
                                    <td class="slds-text-align--right tdBudget" Style="width:60px"><b>${!TotalExpensewrappers.sumactualCash}</b></td>
                                    <td class="slds-text-align--right tdBudget" Style="width:60px"><b>${!TotalExpensewrappers.sumactualInKind}</b></td>
                                    <td class="slds-text-align--right tdProjected" Style="width:60px"><b>${!TotalExpensewrappers.sumFEPostedCash}</b></td>
                                    <td class="slds-text-align--right tdProjected" Style="width:60px"><b>${!TotalExpensewrappers.sumFEPostedInKind}</b></td>
                                    <td class="slds-text-align--right" Style="width:60px">{!TotalExpensewrappers.sumPtoADiff}%</td>
                                    <td Style="width:60px"></td>                                     </apex:outputpanel>
                            </tr> 
                        </table>
                        <div class="approval-Section">
                            <apex:outputPanel rendered="{!approvalBtnVisibility}">
                                <div class="pull-right" style="margin-right: 2%;margin-top: 2%; margin-bottom:1%">
                                    <apex:selectList size="1" value="{!approverId}" multiselect="false" styleClass="form-control col-lg-2 appr-Id">
                                        <apex:selectOptions value="{!UserListForApproval}"/>
                                    </apex:selectList> 
                                </div>
                                <div class="pull-right" style="margin-right: 2%;margin-top: 2%; margin-bottom:1%">
                                    <apex:commandButton value="Submit For Approval" action="{!submitForApproval}" styleclass="btn btn-info" onclick=" return validateApprover();"/> 
                                </div>
                            </apex:outputPanel>
                        </div>
                        <div class="pull-right" style="margin-right: 2%;margin-top: 2%; margin-bottom:1%">
                            <apex:commandButton value="Save" action="{!SaveExpenses}" styleclass="btn btn-info" /> 
                        </div>
                    </apex:pageBlock>  
                </div>
            </div>   
        </apex:form>
        
        
    
        <div style="padding:20px !important">
            <apex:pageBlock title="Budget Approval History" id="ApprovalPageBlock">
            <div class="pbBody" style="font-size: 11px !important">
                
                <table class="slds-table slds-table--bordered slds-table--striped slds-table--cell-buffer" border="0" cellpadding="0" cellspacing="0">
                    <tbody>
                        <tr class="dataRow" id="headerRow">
                            <td class="slds-cell-wrap"></td>
                            <td class="slds-cell-wrap"></td>                  
                            <td class="slds-cell-wrap" colspan="3">
                                <!--<apex:outputLink rendered="{!aSW.isSubmitForApproval}" styleclass="btn btn-info btn-sm" title="Submit For Budget Approval" target="_parent" value="{!URLFOR($Action.Case.Submit,$CurrentPage.Parameters.caseId)}">
                                    Submit For Budget Approval
                                </apex:outputLink>-->
                                <apex:outputLink rendered="{! !aSW.isSubmitForApproval}" styleclass="btn btn-info btn-sm" title="Recall Budget Approval Request" target="_parent" value="{!aSW.recallApprovalProcessLink}">
                                    Recall Budget Approval Request
                                </apex:outputLink>
                            </td>
                            <td class="slds-cell-wrap"></td>
                            <td class="slds-cell-wrap"></td>                                                        
                        </tr>
                        <tr class="headerRow">
                            <th>Action</th>
                            <th>Date</th>
                            <th>Status</th>
                            <th>Assigned To</th>
                            <th>Comments</th>
                            <th>Actual Approver</th>
                            <th>Overall Status</th>
                        </tr>                   
                        <apex:repeat value="{!aSW.approvals}" var="s">
                            <tr class="overAllStatusRow dataRow" id="overAllStatusRow">
                                <td colspan="6" class="dataCell">
                                    {!IF(AND(s['listOfSteps'][0].stepstatus != 'Started', s['listOfSteps'][0].ProcessNode.Name != NULL),IF( s['listOfSteps'][0].stepstatus !='Removed','Step : '+s['listOfSteps'][0].ProcessNode.Name + IF(s['listOfSteps'][0].stepstatus=='Pending',' (Pending for first approval) ',''),'Approval Request Recalled'), 'Approval Request Submitted')}
                                </td>
                                <td class="dataCell {!s['listOfSteps'][0].stepstatus}">
                                    {!IF(AND(s['listOfSteps'][0].stepstatus != 'Started',s['listOfSteps'][0].stepstatus != 'NoResponse'),IF( s['listOfSteps'][0].stepstatus !='Removed',s['listOfSteps'][0].stepstatus,'Recalled'), '')}
                                </td>
                            </tr>
                            <apex:repeat var="step" value="{!s.listOfSteps}">
                                <tr class="dataRow">
                                    <td class="slds-cell-wrap">
                                        <apex:outputText rendered="{!step.stepstatus == 'Pending'}">
                                            <a href="{!s.workItemReassignLink}" target="_parent">Reassign</a> | <a href="{!s.workItemApproveOrRejectLink}" target="_parent"> Approve / Reject</a>
                                        </apex:outputText>
                                    </td>
                                    <td class="slds-cell-wrap">
                                        <apex:outputText value="{0,date,dd/MM/YYYY HH:mm:ss}">
                                            <apex:param value="{!step.CreatedDate}"/>
                                        </apex:outputText> 
                                    </td>
                                    <td class="slds-cell-wrap">{!IF(step.Stepstatus!='NoResponse',step.Stepstatus,'')}</td>
                                    <td class="slds-cell-wrap"><a href="/{!step.OriginalActorID}" target='_parent'>{!step.OriginalActor.Name}</a></td>
                                    <td class="slds-cell-wrap">{!step.comments}</td>
                                    <td class="slds-cell-wrap"><a href="/{!step.ActorId}" target='_parent'>{!step.Actor.Name}</a></td>
                                    <td></td>
                                </tr>
                            </apex:repeat>
                        </apex:repeat>
                    </tbody>
                </table>
            </div>
        </apex:pageBlock>
        </div>
    </div>
    <apex:includeScript value="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"/>
    <script>
    function validateNewExpenseType() {
        if($('.new-expType').val() == '') {
            alert('Please Select Expense Type');
            return false;
        } else {
            return true;
        }
    }
    
    function validateApprover() {
        if($('.appr-Id').val() == '') {
            alert('Please Select Approver');
            return false;
        } else {
            return true;
        }
    }
    
    </script>
    
    
</apex:page>
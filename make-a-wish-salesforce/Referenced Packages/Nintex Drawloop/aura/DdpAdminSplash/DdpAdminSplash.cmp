<aura:component >
    <!--Attributes passed in from DDP Admin-->
    <aura:attribute name="loopUrl" type="string" default=""/>
    <aura:attribute name="isStandard" type="boolean" default="true" required="true"/>
    <aura:attribute name="isSandbox" type="boolean" default="false" required="true"/>
    
    <!--Internal attributes-->
    <aura:attribute name="hasContract" type="boolean" default="false" access="private"/>
    <aura:attribute name="usedLicenses" type="integer" default="0" access="private"/>
    <aura:attribute name="daysRemainingInTrial" type="integer" default="0" access="private"/>
    <aura:attribute name="allowedLicenses" type="string" default="0" access="private"/>
    <aura:attribute name="licenseButtonLabel" type="string" default="Purchase Nintex Drawloop" access="private"/>
    <aura:attribute name="editionHeader" type="string" default="Business Edition"/>
    <aura:attribute name="customizeApplication" type="boolean" default="true" required="true"/>
    <aura:attribute name="isLoading" type="boolean" default="true"/>
    
    <aura:registerEvent name="redirectPage" type="Loop:redirectPage"/>
    
    <aura:method name="load" action="{!c.load}">
        <aura:attribute name="hasContract" type="boolean" default="false"/>
        <aura:attribute name="usedLicenses" type="integer" default="0"/>
        <aura:attribute name="daysRemainingInTrial" type="integer" default="0"/>
        <aura:attribute name="allowedLicenses" type="integer" default="0"/>
    </aura:method>
    
    <div class="slds">
        <aura:if isTrue="{!v.isLoading}">
             <div aura:id="loading" class="loading-container" style="min-width:60rem;height:40rem;">
                <div class="slds-grid slds-grid--align-center" style="width:100%;height:100%;">
                    <div id="spinner-container" class="slds-align-middle">
                        <div style="width:80px;">
                            <img src="/resource/Loop__SalesforceLightning/assets/images/spinners/slds_spinner_brand.gif" alt="Loading..." />
                        </div>
                    </div>
                </div>
            </div>
            <aura:set attribute="else">
                <div class="slds-m-left--xxx-small slds-grid slds-grid--vertical-stretch">
                    <div class="slds-col cell">
                        <div class="border slds-float--left block">
                            <Loop:Svg xlinkHref="/resource/Loop__SalesforceLightning/assets/icons/standard-sprite/svg/symbols.svg#apps_admin" class="slds-icon__container slds-icon__container--square button-icon-color slds-icon slds-icon--medium"/>
                            <h1 class="slds-text-heading--medium slds-m-bottom--medium slds-m-left--small iconFloat" style="vertical-align: top;">Classic Experience Buttons</h1>
                            <h2 class="slds-text-heading--small slds-m-bottom--small">Basic Buttons</h2>
                            <div>Add single-record buttons to page layouts on standard or custom objects. Users can use these buttons in the Salesforce classic experience and will see the classic DDP experience. For adding Salesforce Lightning buttons, see <a href="http://help.nintex.com/en-us/docgen/docservices/Default.htm#cshid=9028" target="_blank">Run DDPs in Salesforce Lightning</a>.</div><br/>
                            <button id="basicButtons" class="slds-button slds-button--brand" onclick="{!c.redirectPage}">Add Basic Buttons</button>
                            <hr/>
                            <h2 class="slds-text-heading--small slds-m-bottom--small">Button Wizard</h2>
                            <div class="slds-word-wrap">Create single-record or Mass DDP elements (buttons, links, or tabs) for running DDPs in the Salesforce classic experience.</div><br/>
                            <button id="buttonWizard" class="slds-button slds-button--brand" onclick="{!c.redirectPage}">Create Advanced Buttons</button>
                        </div>
                        <div class="block slds-float--left border borderbelow slds-m-top--small" style="min-height:336px;">
                            <h1 class="slds-text-heading--medium slds-m-bottom--small" style="vertical-align: top;">Authorize Drawloop Document Generation</h1>
                            <Loop:AuthorizeLoopServices customizeApplication="{!v.customizeApplication}" loopUrl="{!v.loopUrl}"/>
                        </div>
                    </div>
                    <div class="slds-col slds-m-left--small slds-m-right--small supportcell">
                        <aura:if isTrue="{!!v.isSandbox}">
                            <div class="border slds-m-bottom--small" style="height:calc(100% - 552px);">
                                <Loop:Svg xlinkHref="/resource/Loop__SalesforceLightning/assets/icons/custom-sprite/svg/symbols.svg#custom15" class="slds-icon__container slds-icon__container--square license-icon-color slds-icon slds-icon--medium"/>
                                <h1 class="slds-text-heading--medium slds-m-bottom--small slds-m-left--small iconFloat" style="vertical-align: top;">License</h1>
                                <aura:if isTrue="{!!v.hasContract}">
                                    <h2 class="slds-text-body--regular">Trial Expires in {!v.daysRemainingInTrial} Day{!v.daysRemainingInTrial == 1 ? '' : 's'}</h2>
                                    <aura:set attribute="else">
                                        <aura:if isTrue="{!v.isStandard}">
                                            <h2 class="slds-text-body--regular">Standard Edition</h2>
                                            <aura:set attribute="else">
                                                <h2 class="slds-text-body--regular">Business Edition</h2>
                                            </aura:set>
                                        </aura:if>
                                    </aura:set>
                                </aura:if>
                                <h2 class="slds-text-body--regular slds-m-bottom--small">{!v.usedLicenses} of {!v.allowedLicenses} users provisioned</h2>
                                <button id="purchaseForm" class="slds-button slds-button--brand" onclick="{!c.redirectPage}">{!v.licenseButtonLabel}</button>
                            </div>
                        </aura:if>
                        <div class="border" style="{!!v.isSandbox ? 'height:540px;' : 'height:100%'}">
                            <Loop:SupportSidebar />
                        </div>
                    </div>
                </div>
            </aura:set>
        </aura:if>
    </div>
</aura:component>
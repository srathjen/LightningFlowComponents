<apex:page standardController="Contact" extensions="ChapterChangeConfirmationPopup_AC">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <apex:outputPanel rendered="{!AND(OR(Contact.Hidden_Chapter__c != null, Contact.Hidden_Chapter__c != ''), Contact.Hidden_Chapter__c != Contact.Region_Chapter__c)}">
        <script>
        $(document).ready(function() {
        var myUserContext = "{!$User.UITheme}";
        setTimeout(function() { 
            var isConfirm = confirm("Are you sure you want to reassign this contact to a new chapter?");
            if (isConfirm) {
                ChapterChangeConfirmationPopup_AC.updateContactChapter('accept','{!Contact.Id}', function(result,event) { 
                    if(event.type == 'exception') {
                        alert(event.message);
                    }                  
                });                
                return false;
            } else {
                ChapterChangeConfirmationPopup_AC.updateContactChapter('revert','{!Contact.Id}', function(result,event) { 
                    if(event.type == 'exception') {
                        alert(event.message);
                    } else {
                        if(result) {    
                            if (myUserContext == 'Theme4t' || myUserContext == 'Theme4d' || myUserContext == 'Theme4u') {                                
                                sforce.one.navigateToURL('/' + '{!Contact.Id}', true);
                            } else if (myUserContext == 'Theme3') {                                
                                window.top.location = '/' + '{!Contact.Id}';
                            }                             
                        }                           
                    }                       
                });
                return false;
            }
        }, 2000);                             
    }); 
    </script>
</apex:outputPanel>
</apex:page>